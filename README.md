## 目录结构

```
项目根目录
├── source/                      源代码目录
│   ├── macro_config.txt         配置文件 (在此编辑宏命令)
│   └── macro.py                 宏脚本   (运行这个 python 脚本启动宏监听)
├── README.md                    项目说明
└── requirements.txt             依赖清单
```

## 如何安装

安装 Python

安装依赖

```
pip install keyboard mouse colorama
```

编辑配置文件

```
# 示例

[技能1]
触发键 = 1
循环 = 是
按下 q
等待 25ms

[基础攻击连招]
触发键 = 1
重复 = 按住时
动作 =
  按下 空格
  按下 q
  按下 w
  按下 e
  按下 r
```

运行脚本
```
python source/macro.py
```


## 使用说明

```
【常用指令】
• 按下 <键>          - 按一次键
• 等待 <时间>        - 延迟（支持 100ms, 0.1s）
• 左键/右键/中键     - 鼠标点击
• 双击左键/双击右键  - 鼠标双击

【重复模式】
• 循环 = 是          - 持续循环
• 重复 = 按住时      - 按住期间重复

【高级选项】
• 附加按键 = shift   - 同时按住其他键
• 重置按键 = 是      - 触发时立即释放所有键
• 默认延迟 = 5ms     - 自动插入延迟

【全局热键】
F10   - 暂停/恢复
F11   - 重新加载配置
F12   - 退出程序
ESC×2 - 紧急停止
"""
```

## 功能列表

```
# ==========================================
# 使用说明
# ==========================================
# 1. 在 [方括号] 中定义宏的名称
# 2. 触发键 = 设置热键
#    - 单个键：f1-f12, a-z, 0-9, 小键盘1 等
#    - 组合键：ctrl+1, alt+q, ctrl+shift+f 等
# 3. 动作 = 后面列出所有要执行的动作
# 4. 支持的动作指令：
#    - 按下 <键>：按一下键
#      * 单个键：按下 q
#      * 多个键（逗号/顿号分隔）：按下 q,w,e 或 按下 q、w、e
#    - 按住 <键> <时间>：长按键
#    - 等待 <时间>：延迟
#    - 左键/右键/中键/侧键1/侧键2：鼠标单击
#    - 双击左键/双击右键/双击中键：鼠标双击
#    - 双击侧键1/双击侧键2：侧键双击
#    - 支持一行多指令：按下 q  等待 5ms  按下 w  等待 10ms
# 5. 时间格式支持：100ms, 0.1s, 1秒
# 6. 重复模式：
#    - 默认：执行一次
#    - 循环 = 是：持续循环直到再次按键
#    - 重复 = 按住时：按住期间重复执行
# 7. 重置按键 = 是：
#    宏执行完成后自动释放所有按住的键
# 8. 默认延迟 = 5ms：
#    自动在每个动作后插入此延迟，无需每行都写 "等待 5ms"
#    - 示例：设置"默认延迟 = 5ms"后，写"按下 q"会自动变成"按下 q + 等待 5ms"
#    - 如果某行已有延迟指令，则不会重复插入
#    - 不影响最后一个动作（最后不会添加延迟）
# 9. 附加按键 = shift：
#    按住触发键时同时按住这些键，松开触发键时同时松开
#    - 支持单个键：附加按键 = shift
#    - 支持多个键：附加按键 = shift ctrl（空格或逗号分隔）
# 10. 起始动作 =
#    宏第一次触发时执行的动作（只在第一次执行，重复模式下不会每次都执行）
#    - 语法和普通动作完全相同
#    - 示例：
#      起始动作 =
#        按下 esc  等待 100ms
#        按下 i
# 11. 结束动作 =
#    宏执行完成后执行的动作
#    - 语法和普通动作完全相同
#    - 不会在宏被中断时执行，仅在正常完成时执行
#    - 示例：
#      结束动作 =
#        按下 esc
#        等待 100ms
# 12. 跳过窗口检测 = 是：
#    跳过窗口焦点检测，宏将持续执行而不管当前窗口
#    - 适用于鼠标连点等高频操作，避免因窗口焦点切换导致宏中断
#    - 使用时请谨慎，确保不会在错误的窗口中执行
# 13. 特殊键支持：
#    - 空格、回车、退格、删除、制表、逃逸、换挡、控制、替换
#    - 上、下、左、右（方向键）
#    - 小键盘0-9、小键盘加、小键盘减、小键盘乘、小键盘除
#    - 小键盘点、小键盘回车
# 14. 组合键说明：
#    - 使用 + 连接多个键，如：ctrl+1, alt+q
#    - 支持二键组合：ctrl+a, shift+f, alt+1
#    - 支持三键组合：ctrl+shift+f, ctrl+alt+q
#    - 修饰键：ctrl, shift, alt
#    - 示例：ctrl+小键盘1, alt+space
# 【智能按键缓冲机制】
# - 针对不同模式的宏采用不同的缓冲策略：
#   * "按住时"模式：新按键立即中断当前宏（不缓冲）
#   * "单次/循环"模式：只有在 0.2 秒内连按才会缓冲（避免误触）
# - 缓冲队列最大容量：10 个宏
# - 可在 macro_runner.py 的 Config 类中修改配置：
#   * INPUT_BUFFER_ENABLED = True/False (启用/禁用)
#   * INPUT_BUFFER_SIZE = 10 (队列大小)
#   * RAPID_PRESS_THRESHOLD = 0.2 (连按时间阈值，秒)
```
